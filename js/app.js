// Generated by CoffeeScript 1.3.3
(function() {

  $(function() {
    var aspect, getHeight, getRatio, getWidth, setBodySize, setVideoSize, sidebarOpened, tap, toggleSidebar, tooTall, transition_end;
    aspect = {
      width: 16,
      height: 9
    };
    transition_end = 'webkitTransitionEnd transitionend';
    tap = 'click touchend';
    getRatio = function() {
      return aspect.width / aspect.height;
    };
    getHeight = function(w) {
      return w / getRatio();
    };
    getWidth = function(h) {
      return h * getRatio();
    };
    tooTall = function(h) {
      return (h <= window.innerHeight) != null;
    };
    sidebarOpened = function() {
      return $('body').hasClass('sidebar-open') === true;
    };
    setVideoSize = function() {
      var height, video;
      video = $('video');
      height = getHeight(video.width());
      if (!sidebarOpened()) {
        height = window.innerHeight;
      }
      return video.height(height);
    };
    setVideoSize();
    toggleSidebar = function(e) {
      if (e != null) {
        e.preventDefault();
      }
      $('body').toggleClass('sidebar-open');
      return $('#toggle-sidebar').one(transition_end, function() {
        if (!sidebarOpened()) {
          return setVideoSize();
        }
      });
    };
    $('#toggle-sidebar').on(tap, toggleSidebar);
    setBodySize = function() {
      $('body').height(window.innerHeight).width(window.innerWidth);
    };
    setBodySize();
    $(document).on('touchstart touchmove', false);
    $('#video').on(tap, function() {
      if (this.paused || this.ended) {
        this.play();
      }
      if (!sidebarOpened()) {
        return toggleSidebar();
      }
    });
  });

}).call(this);
